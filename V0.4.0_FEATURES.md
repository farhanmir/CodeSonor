# CodeSonor v0.4.0 - Major Feature Release

## 🎉 What's New in v0.4.0

CodeSonor v0.4.0 is a **major release** that adds 8 powerful new features to transform how you analyze and monitor your repositories!

## 🚀 New Features

### 1. **Repository Comparison** 📊
Compare two repositories side-by-side with comprehensive metrics analysis.

```bash
# Compare two repositories
codesonor analyze https://github.com/user/repo1 --compare https://github.com/user/repo2
```

**Features:**
- Side-by-side language distribution comparison
- Structural metrics comparison (files, lines, directories)
- Quality score comparison
- Visual diff highlighting
- Automated comparison summaries

---

### 2. **Intelligent Caching** 💾
Supercharge analysis speed with SQLite-backed intelligent caching.

```bash
# Enable caching (results cached for 1 hour by default)
codesonor analyze https://github.com/user/repo --cache

# Custom cache TTL (cache for 2 hours)
codesonor analyze https://github.com/user/repo --cache --cache-ttl 7200

# View cache statistics
codesonor cache stats

# Clear cache
codesonor cache clear

# Clean expired entries
codesonor cache clean
```

**Features:**
- SQLite database for persistent caching
- Configurable TTL (time-to-live)
- Cache hit tracking
- Automatic cache expiration
- Per-repository cache management
- Cache statistics dashboard

---

### 3. **Code Quality Score** ⭐
Comprehensive code quality analysis with actionable insights.

```bash
# Calculate quality score
codesonor analyze https://github.com/user/repo --quality-score
```

**Scoring Dimensions:**
- **Documentation** (20%): README, docstrings, comments, CONTRIBUTING
- **Complexity** (25%): File sizes, function complexity, nesting depth
- **Structure** (20%): Directory organization, package structure, config files
- **Best Practices** (20%): CI/CD, .gitignore, dependency management, security
- **Maintainability** (15%): Code duplication, naming consistency, average file size

**Output:**
- Overall score (0-100) with letter grade (A-F)
- Component breakdown scores
- Specific issues detected
- Actionable recommendations

---

### 4. **Export Formats** 📤
Export analysis results in multiple formats for reporting and documentation.

```bash
# Export to JSON
codesonor analyze https://github.com/user/repo --export json --export-path report.json

# Export to HTML (beautiful visual report)
codesonor analyze https://github.com/user/repo --export html --export-path report.html

# Export to Markdown
codesonor analyze https://github.com/user/repo --export markdown --export-path report.md
```

**Supported Formats:**
- **JSON**: Machine-readable data for integration
- **HTML**: Beautiful, interactive visual report with charts and styling
- **Markdown**: Documentation-ready format for README/wikis

---

### 5. **Watch Mode** 👀
Continuously monitor repositories for changes and auto-reanalyze.

```bash
# Watch mode with 10-second interval (default)
codesonor analyze /path/to/local/repo --watch

# Custom watch interval (30 seconds)
codesonor analyze /path/to/local/repo --watch --watch-interval 30
```

**Features:**
- Continuous file monitoring
- Intelligent change detection (MD5 hashing)
- Debounced re-analysis
- Ignores common directories (node_modules, .git, __pycache__)
- Real-time change notifications
- Press Ctrl+C to stop

---

### 6. **Custom Rules Engine** 🔧
Define custom analysis rules specific to your project.

```bash
# Initialize rules config
codesonor init-rules /path/to/project

# Run analysis with custom rules
codesonor analyze /path/to/project --custom-rules
```

**Create `.codesonor.yml` in your project:**

```yaml
rules:
  - id: no-print-statements
    name: No Print Statements
    description: Avoid using print() in production code
    pattern: ^\s*print\s*\(
    severity: warning
    file_patterns:
      - '**/*.py'
    enabled: true
  
  - id: no-hardcoded-passwords
    name: No Hardcoded Passwords
    description: Potential hardcoded password detected
    pattern: password\s*=\s*["'][^"']+["']
    severity: error
    file_patterns:
      - '**/*.py'
      - '**/*.js'
    enabled: true
```

**Built-in Rules:**
- No print statements
- No TODO comments
- No hardcoded passwords
- No broad exception catching
- No debug code
- Line length checks

---

### 7. **Language-Specific Insights** 🌐
Deep analysis with framework detection and best practices for popular languages.

```bash
# Get language-specific insights
codesonor analyze https://github.com/user/repo --language-insights
```

**Supported Languages:**

#### **Python**
- Framework detection (Django, Flask, FastAPI, Pandas, TensorFlow, PyTorch)
- Dependency analysis (requirements.txt, Pipfile, Poetry)
- Project type detection (Web, Data Science, CLI, Library)
- Best practices (virtual env, type hints, docstrings)
- Testing framework detection (pytest, unittest)
- Packaging configuration analysis

#### **JavaScript/TypeScript**
- Framework detection (React, Vue, Angular, Next.js, Express, NestJS)
- Dependency analysis (package.json)
- Project type detection (Frontend, Backend, Full-stack)
- Best practices (ESLint, Prettier, TypeScript)
- Testing framework detection (Jest, Mocha, Vitest)
- Bundler detection (Webpack, Vite, Rollup)

#### **Java**
- Framework detection (Spring Boot, Hibernate)
- Build tool detection (Maven, Gradle)
- Project type detection

#### **Go**
- Framework detection (Gin, Gorilla Mux, Echo)
- Module system analysis (go.mod, go.sum)
- Project type detection

---

### 8. **Interactive Dashboard** 📺
Real-time metrics visualization in your terminal.

```bash
# Launch interactive dashboard
codesonor analyze https://github.com/user/repo --interactive
```

**Features:**
- Real-time metrics display
- Multiple views (Overview, Quality, Languages)
- Visual progress bars
- Keyboard navigation
- Live updates
- Beautiful terminal UI with Rich library

**Controls:**
- `q` - Quit
- `r` - Refresh
- `1` - Overview view
- `2` - Quality view
- `3` - Languages view

---

## 🔥 Feature Combinations

Combine features for maximum power:

```bash
# Complete analysis with all features
codesonor analyze https://github.com/user/repo \
  --quality-score \
  --language-insights \
  --custom-rules \
  --cache \
  --export html \
  --export-path full-report.html

# Compare two repos with caching and export
codesonor analyze https://github.com/user/repo1 \
  --compare https://github.com/user/repo2 \
  --cache \
  --export markdown \
  --export-path comparison.md

# Monitor local project with custom rules
codesonor analyze /path/to/project \
  --watch \
  --custom-rules \
  --quality-score \
  --cache
```

---

## 📈 Performance Improvements

- **Caching**: 10-100x faster for repeated analyses
- **Efficient file scanning**: Ignores unnecessary directories
- **Debounced watch mode**: Prevents redundant analyses
- **Optimized quality scoring**: Samples files for faster analysis

---

## 🛠️ Technical Details

### New Modules
- `cache_manager.py` - SQLite-backed caching system
- `quality_scorer.py` - Comprehensive quality analysis
- `exporter.py` - Multi-format export functionality
- `comparator.py` - Repository comparison engine
- `watcher.py` - File monitoring and change detection
- `rules_engine.py` - Custom rules and validation
- `language_insights.py` - Deep language-specific analysis
- `dashboard.py` - Interactive terminal dashboard

### New Dependencies
- `pyyaml>=6.0.0` - For custom rules configuration

### Database
- Cache stored in `~/.codesonor/cache/analysis_cache.db`
- Uses SQLite for reliability and performance
- Automatic index creation for fast lookups

---

## 🎯 Use Cases

### For Developers
- **Quick comparison**: Compare your fork with the original repository
- **Quality tracking**: Monitor code quality over time
- **Local development**: Watch mode for continuous analysis during development
- **Custom standards**: Enforce team-specific coding standards with custom rules

### For Teams
- **Code reviews**: Generate HTML reports for review meetings
- **Documentation**: Export Markdown for project wikis
- **CI/CD integration**: Use JSON export in automated pipelines
- **Best practices**: Language-specific insights for onboarding

### For Open Source Maintainers
- **Repository health**: Regular quality score monitoring
- **Comparison**: Compare branches or competing implementations
- **Documentation**: Generate beautiful HTML reports for contributors

---

## 🚀 Upgrade Path

```bash
# Upgrade from v0.3.0
pip install --upgrade codesonor

# Verify new version
codesonor --version  # Should show 0.4.0

# Try new features
codesonor analyze https://github.com/user/repo --quality-score --interactive
```

---

## 📝 Breaking Changes

None! v0.4.0 is fully backward compatible with v0.3.0.

---

## 🐛 Bug Fixes

- Improved error handling in LLM provider selection
- Better handling of large repositories
- Enhanced path resolution for cross-platform compatibility

---

## 🙏 Acknowledgments

Thanks to the open source community for inspiration and feedback!

---

## 📚 Documentation

- Full CLI documentation: `CLI_README.md`
- Multi-LLM setup: `MULTI_LLM.md`
- Main documentation: `README.md`

---

## 🔮 What's Next?

Upcoming features for v0.5.0:
- Dependency vulnerability scanning
- Git history analysis
- Team collaboration insights
- API server mode
- VS Code extension

---

**Happy Analyzing! 🎉**

*CodeSonor v0.4.0 - Making code analysis powerful, fast, and beautiful.*
